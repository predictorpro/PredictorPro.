<!DOCTYPE html>
<html lang="ar-DZ" class="dark">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>PredictorPro – الألغام</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script> tailwind.config = { darkMode: 'class' }; </script>
  <style>
    /* Фиксированный фон как на aviator/penalty */
    body.diamond-bg{ background: none !important; position: relative; }
    body.diamond-bg::before{
      content:""; position: fixed; inset:0; z-index:-1; pointer-events:none;
      background-color:#fff;
      background-image:
        linear-gradient(to bottom, rgba(255,255,255,1) 0%, rgba(255,255,255,1) 40%, rgba(255,255,255,0.85) 50%, rgba(255,255,255,0) 65%),
        repeating-linear-gradient(45deg, rgba(22,163,74,.15) 0 12px, rgba(22,163,74,0) 12px 24px),
        repeating-linear-gradient(-45deg, rgba(22,163,74,.15) 0 12px, rgba(22,163,74,0) 12px 24px),
        linear-gradient(to bottom, #ecfdf5, #d1fae5);
      background-size:auto,40px 40px,40px 40px,auto;
      background-position: top left, center, center, center;
    }
    .dark body.diamond-bg::before{
      background-color:#000;
      background-image:
        linear-gradient(to bottom, rgba(0,0,0,1) 0%, rgba(0,0,0,1) 40%, rgba(0,0,0,0.85) 50%, rgba(0,0,0,0) 65%),
        repeating-linear-gradient(45deg, rgba(22,163,74,.25) 0 12px, rgba(22,163,74,0) 12px 24px),
        repeating-linear-gradient(-45deg, rgba(22,163,74,.25) 0 12px, rgba(22,163,74,0) 12px 24px),
        linear-gradient(to bottom, #052e16, #065f46);
      background-size:auto,40px 40px,40px 40px,auto;
      background-position: top left, center, center, center;
    }
  </style>
</head>
<body class="min-h-screen bg-white dark:bg-black text-gray-900 dark:text-white relative diamond-bg">

  <!-- Верхний бар -->
  <header class="fixed top-0 left-0 right-0 z-30 backdrop-blur-md bg-white/70 dark:bg-black/40 border-b border-green-700/30">
    <div class="max-w-[74rem] mx-auto px-4 py-2 flex items-center justify-between gap-3 sm:gap-4 flex-wrap">
      <!-- Логотип (домой) -->
      <a href="main.html" class="shrink-0 flex items-center gap-2">
        <img src="images/PredictorPro.jpg" alt="PredictorPro"
             class="w-16 h-16 sm:w-24 sm:h-24 lg:w-32 lg:h-32 rounded-full border-4 border-green-700 object-cover"/>
      </a>

      <!-- Правый блок: онлайн + язык + тема -->
      <div class="flex items-center gap-3 sm:gap-4">
        <!-- Онлайн -->
        <div class="flex items-center gap-2 px-2.5 py-1 rounded-full border border-green-600/70 bg-white/60 dark:bg-white/10 shadow-md">
          <span class="relative flex h-3 w-3">
            <span class="animate-ping absolute inline-flex h-full w-full rounded-full bg-green-500 opacity-75"></span>
            <span class="relative inline-flex rounded-full h-3 w-3 bg-green-500"></span>
          </span>
          <span id="onlineLabel" class="hidden sm:inline text-xs sm:text-sm font-semibold text-green-700 dark:text-green-400">متصل</span>
          <span id="activeUsersCount" class="text-xs sm:text-sm font-semibold text-green-700 dark:text-green-400">—</span>
        </div>

        <!-- Язык -->
        <div class="relative">
          <button id="langBtn"
                  class="h-10 px-4 rounded-full bg-gray-200 text-gray-900 shadow ring-2 ring-green-600 text-sm font-semibold flex items-center gap-2"
                  aria-haspopup="true" aria-expanded="false" aria-label="اختيار اللغة">
            <span>🌐</span><span id="langBtnLabel">العربية</span>
          </button>
          <div id="langMenu"
               class="hidden absolute right-0 mt-2 w-18 bg-gray-800 text-white rounded-lg shadow-lg border border-green-700/60 overflow-hidden text-sm z-50">
            <button data-lang="ar" data-dir="rtl"  data-langtag="ar-DZ" class="w-full text-right px-3 py-2 hover:bg-gray-700">العربية</button>
            <button data-lang="es" data-dir="ltr"  data-langtag="es-PE" class="w-full text-left  px-3 py-2 hover:bg-gray-700">Español</button>
            <button data-lang="en" data-dir="ltr"  data-langtag="en"     class="w-full text-left  px-3 py-2 hover:bg-gray-700">English</button>
            <button data-lang="pl" data-dir="ltr"  data-langtag="pl"     class="w-full text-left  px-3 py-2 hover:bg-gray-700">Polski</button>
            <button data-lang="fr" data-dir="ltr"  data-langtag="fr"     class="w-full text-left  px-3 py-2 hover:bg-gray-700">Français</button>
          </div>
        </div>

        <!-- Тема -->
        <button id="themeToggle"
                class="w-10 h-10 sm:w-12 sm:h-12 flex items-center justify-center rounded-full bg-gray-200 dark:bg-gray-700 shadow-lg transition-colors ring-2 ring-green-600 ring-offset-2 ring-offset-transparent"
                onclick="toggleTheme()" aria-label="Cambiar tema">🌙</button>
      </div>
    </div>
  </header>

  <!-- FAQ-кнопка (слева внизу на мобилках) -->
  <div id="faqButton"
       class="fixed left-4 bottom-4 sm:top-1/2 sm:bottom-auto sm:right-4 sm:left-auto sm:-translate-y-1/2
              flex items-center gap-2 p-2 bg-gray-200 dark:bg-gray-800 rounded-lg cursor-pointer shadow transition-colors z-20">
    <img src="images/311092c3467c45c938fd5b63ac29281a.png" alt="FAQ" class="w-8 h-8"/>
    <span id="faqBtnLabel" class="font-semibold text-gray-900 dark:text-white">الأسئلة الشائعة</span>
  </div>

  <!-- FAQ-панель -->
  <div id="faqPanel"
       class="fixed left-4 right-4 bottom-24 sm:left-auto sm:right-4 sm:top-1/2 sm:bottom-auto sm:-translate-y-1/2
              w-auto sm:w-80 bg-gray-100 dark:bg-gray-900 rounded-lg shadow-lg p-4 hidden text-gray-900 dark:text-white z-50">
    <button id="faqClose"
            class="absolute top-2 right-2 text-gray-500 dark:text-gray-400 hover:text-gray-700 dark:hover:text-gray-200 text-xl leading-none">&times;</button>

    <h3 id="faqTitle" class="text-lg font-semibold mb-2">قواعد لعبة «الألغام»</h3>

    <h4 id="faqQ1" class="text-md font-semibold mb-1">1) كيف يعمل التنبؤ؟</h4>
    <p id="faqA1" class="text-sm mb-3">
      عند الضغط على «احصل على التنبؤ»، يحلل النظام الجولات السابقة وتوزيع احتمالات الألغام.
      بعد محاكاة قصيرة (3 ثوانٍ) تُكشف خلية واحدة — وهي إشارتك للجولة.
    </p>

    <h4 id="faqQ2" class="text-md font-semibold mb-1">2) كم مرة يمكنني الكشف؟</h4>
    <p id="faqA2" class="text-sm mb-3">
      يمكنك كشف ما يصل إلى 5 خلايا لكل دورة. في النقرة السادسة نعرض نصيحة لتثبيت الربح،
      ثم تبدأ دورة جديدة.
    </p>

    <h4 id="faqQ3" class="text-md font-semibold mb-1">3) هل يمكنني تغيير عدد الألغام؟</h4>
    <p id="faqA3" class="text-sm">
      نعم، في إعدادات اللعبة يمكنك اختيار من 1 إلى 3 ألغام قبل كل جولة.
    </p>
  </div>

  <!-- Контент с отступом под шапку -->
  <main class="pt-28 sm:pt-36 lg:pt-48 pb-44 sm:pb-28 flex flex-col items-center space-y-6 px-4">
    <!-- === КВАДРАТНОЕ ОКНО ПРОГНОЗОВ === -->
    <div class="w-full max-w-md z-10">
      <div class="relative aspect-square">
        <!-- Сетка «мин» заполняет квадрат целиком -->
        <div id="minesGrid"
             class="absolute inset-0 grid grid-cols-5 grid-rows-5 gap-3 sm:gap-4 p-3 sm:p-5 bg-gray-100 dark:bg-gray-800 rounded-2xl shadow-md border-2 border-green-700 transition-colors">
          <!-- Ячейки создаются JS -->
        </div>
        <!-- Оверлей для сообщений поверх квадрата -->
        <div id="overlay"
             class="absolute inset-0 flex items-center justify-center bg-white/80 dark:bg-black/70
                    text-center text-xl font-semibold text-gray-900 dark:text-white hidden rounded-2xl p-4"></div>
      </div>
    </div>

    <!-- Кнопки (как на penalty): в одну линию на мобилках -->
    <div class="flex gap-2 w-full max-w-md flex-nowrap">
      <button id="fetchBtn"
              class="px-4 sm:px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-2xl font-semibold transition-colors flex-1 min-w-0">
        احصل على التنبؤ
      </button>
      <button id="resetBtn"
              class="w-10 h-10 bg-gray-200 dark:bg-gray-700 rounded-lg flex items-center justify-center shadow transition-colors"
              aria-label="إعادة تعيين">
        <img src="images/7646bf17f356f37147352829310cbf50.png" alt="Reload" class="w-6 h-6"/>
      </button>
    </div>
  </main>

  <!-- SUPPORT CHAT -->
  <div class="fixed bottom-4 right-4 z-30 flex flex-col items-center space-y-2 p-3 rounded-2xl border-2 border-green-700/70 bg-white/70 dark:bg-white/10 backdrop-blur-md shadow-xl">
    <a href="https://t.me/Pedro_PredictorPro_bot"
       class="bg-gray-200 dark:bg-gray-800 p-2 rounded-full border-4 border-green-700 transition-transform hover:scale-105"
       target="_blank" rel="noopener noreferrer" aria-label="Support chat">
      <img src="images/—Pngtree—technical support_3767452.png" alt="Support" class="w-14 h-14 sm:w-16 sm:h-16 filter dark:invert"/>
    </a>
    <span id="supportLabel" class="text-xs sm:text-sm font-semibold text-green-700 dark:text-green-400">دردشة الدعم</span>
  </div>

<script>
  // ===== ТЕМА
  document.documentElement.classList.add('dark');
  const themeToggle = document.getElementById('themeToggle');
  if (themeToggle) themeToggle.textContent = '🌞';
  function toggleTheme() {
    document.documentElement.classList.toggle('dark');
    themeToggle.textContent = document.documentElement.classList.contains('dark') ? '🌞' : '🌙';
  }

  // ==== Онлайн-индикатор (симуляция)
  const usersEl = document.getElementById('activeUsersCount');
  function updateUsers() {
    const min = 120, max = 340;
    usersEl.textContent = Math.floor(min + Math.random() * (max - min));
  }
  updateUsers(); setInterval(updateUsers, 5000);

  // ===== I18N (mines) + строка ресета
  const I18N = {
    ar: { langName:'العربية', langTag:'ar-DZ', dir:'ltr', title:'PredictorPro – الألغام', online:'متصل', support:'دردشة الدعم',
      faqBtn:'الأسئلة الشائعة', faqTitle:'قواعد لعبة «الألغام»',
      q1:'1) كيف يعمل التنبؤ؟',
      a1:'عند الضغط على «احصل على التنبؤ»، يحلل النظام الجولات السابقة وتوزيع احتمالات الألغام. بعد محاكاة قصيرة (3 ثوانٍ) تُكشف خلية واحدة — وهي إشارتك للجولة.',
      q2:'2) كم مرة يمكنني الكشف؟',
      a2:'يمكنك كشف ما يصل إلى 5 خلايا لكل دورة. في النقرة السادسة نعرض نصيحة لتثبيت الربح، ثم تبدأ دورة جديدة.',
      q3:'3) هل يمكنني تغيير عدد الألغام؟',
      a3:'نعم، في إعدادات اللعبة يمكنك اختيار من 1 إلى 3 ألغام قبل كل جولة.',
      btnGet:'احصل على التنبؤ', wait:'الرجاء الانتظار، يتم جلب بيانات الجولة التالية', next:'هل تريد التنبؤ التالي؟',
      reset:'انتظر، جارٍ التحضير لإشارات جديدة', ariaLang:'اختيار اللغة',
      recs:['ثبّت أرباحك','احتفظ بأرباحك','حان وقت الخروج من الصفقة','احتفظ بالعائد المحقق','أفضل وقت لتثبيت الربح','لا تكن جشعاً، احصد الأرباح','احصل على أرباحك','سجّل النتيجة النهائية','كفى مخاطرة، ثبّت','رصيدك إيجابي — توقف']
    },
    es: { langName:'Español', langTag:'es-PE', dir:'ltr', title:'PredictorPro – Minas', online:'En línea', support:'Chat de soporte',
      faqBtn:'Preguntas frecuentes', faqTitle:'Reglas del juego «Minas»',
      q1:'1) ¿Cómo funciona la predicción?',
      a1:'Al pulsar «Obtener predicción», el sistema analiza rondas previas y la distribución de minas. Tras una breve simulación (3 s), se revela una celda — esa es tu señal.',
      q2:'2) ¿Cuántas revelaciones por ciclo?',
      a2:'Hasta 5 celdas por ciclo. En el sexto clic mostramos un consejo para asegurar ganancias y luego comienza un nuevo ciclo.',
      q3:'3) ¿Puedo cambiar la cantidad de minas?',
      a3:'Sí, en los ajustes del juego puedes elegir de 1 a 3 minas antes de cada ronda.',
      btnGet:'Obtener predicción', wait:'Espere, obteniendo datos para la siguiente ronda', next:'¿Desea la siguiente predicción?',
      reset:'Espere, preparando base para nuevas señales', ariaLang:'Seleccionar idioma',
      recs:['Asegura tus ganancias','Conserva tu beneficio','Es momento de salir','Bloquea el rendimiento logrado','Buen momento para asegurar','No seas codicioso, cobra','Toma tus ganancias','Registra el resultado final','Basta de riesgo, asegura','Saldo positivo — detente']
    },
    en: { langName:'English', langTag:'en', dir:'ltr', title:'PredictorPro – Mines', online:'Online', support:'Support chat',
      faqBtn:'FAQ', faqTitle:'Mines Game Rules',
      q1:'1) How does the prediction work?',
      a1:'When you press “Get prediction”, the system analyzes previous rounds and mine distribution. After a 3-second simulation, one cell is revealed — your signal.',
      q2:'2) How many reveals per cycle?',
      a2:'Up to 5 cells per cycle. On the 6th click we show a profit-lock recommendation, then a new cycle starts.',
      q3:'3) Can I change the number of mines?',
      a3:'Yes, in game settings you can choose 1–3 mines before each round.',
      btnGet:'Get prediction', wait:'Please wait, fetching data for the next round', next:'Get next prediction?',
      reset:'Please wait, preparing base for new signals', ariaLang:'Select language',
      recs:['Lock your profit','Keep your winnings','Time to exit the trade','Secure realized return','Great time to lock in','Don’t be greedy — cash out','Take your profits','Record the final score','Enough risk — secure','You’re up — pause now']
    },
    pl: { langName:'Polski', langTag:'pl', dir:'ltr', title:'PredictorPro – Miny', online:'Online', support:'Czat wsparcia',
      faqBtn:'FAQ', faqTitle:'Zasady gry „Miny”',
      q1:'1) Jak działa prognoza?',
      a1:'Po kliknięciu „Pobierz prognozę” system analizuje poprzednie rundy i rozkład min. Po 3 sekundach odsłaniana jest jedna komórka — to Twój sygnał.',
      q2:'2) Ile odsłonięć w cyklu?',
      a2:'Do 5 komórek na cykl. Przy 6. kliknięciu pokazujemy radę, by zabezpieczyć zysk, a następnie zaczyna się nowy cykl.',
      q3:'3) Czy mogę zmienić liczbę min?',
      a3:'Tak, w ustawieniach gry możesz wybrać 1–3 miny przed każdą rundą.',
      btnGet:'Pobierz prognozę', wait:'Proszę czekać, pobieramy dane do następnej rundy', next:'Chcesz następną prognozę?',
      reset:'Proszę czekać, przygotowujemy bazę do nowych sygnałów', ariaLang:'Wybierz język',
      recs:['Zabezpiecz zysk','Zatrzymaj wygraną','Czas wyjść z zakładu','Zabezpiecz osiągnięty wynik','Dobry moment, by zablokować zysk','Nie bądź chciwy — wypłać','Weź swoje zyski','Zapisz wynik końcowy','Dość ryzyka — zabezpiecz','Jesteś na plusie — pauza']
    },
    fr: { langName:'Français', langTag:'fr', dir:'ltr', title:'PredictorPro – Mines', online:'En ligne', support:'Chat de support',
      faqBtn:'FAQ', faqTitle:'Règles du jeu « Mines »',
      q1:'1) Comment fonctionne la prévision ?',
      a1:'En appuyant sur « Obtenir la prévision », le système analyse les manches précédentes et la répartition des mines. Après 3 s, une case est révélée — votre signal.',
      q2:'2) Combien de révélations par cycle ?',
      a2:'Jusqu’à 5 cases par cycle. Au 6ᵉ clic, nous affichons un conseil pour sécuriser le gain, puis un nouveau cycle démarre.',
      q3:'3) Puis-je changer le nombre de mines ?',
      a3:'Oui, dans les paramètres du jeu vous pouvez choisir 1 à 3 mines avant chaque manche.',
      btnGet:'Obtenir la prévision', wait:'Veuillez patienter, récupération des données pour la prochaine manche', next:'Voulez-vous la prochaine prévision ?',
      reset:'Veuillez patienter, préparation de la base pour de nouveaux signaux', ariaLang:'Choisir la langue',
      recs:['Sécurisez vos gains','Gardez vos bénéfices','Il est temps de sortir','Verrouillez le rendement acquis','Bon moment pour sécuriser','Ne soyez pas avide — encaissez','Prenez vos gains','Enregistrez le score final','Assez de risque — sécurisez','Vous êtes gagnant — faites une pause']
    }
  };

  // ===== Узлы
  const htmlEl   = document.documentElement;
  const titleEl  = document.getElementsByTagName('title')[0];
  const langBtn  = document.getElementById('langBtn');
  const langLbl  = document.getElementById('langBtnLabel');
  const langMenu = document.getElementById('langMenu');
  const onlineLabel = document.getElementById('onlineLabel');
  const supportLabel = document.getElementById('supportLabel');

  const faqBtnEl = document.getElementById('faqButton');
  const faqTitleEl = document.getElementById('faqTitle');
  const faqBtnLbl = document.getElementById('faqBtnLabel');
  const faqQ1 = document.getElementById('faqQ1'), faqA1 = document.getElementById('faqA1');
  const faqQ2 = document.getElementById('faqQ2'), faqA2 = document.getElementById('faqA2');
  const faqQ3 = document.getElementById('faqQ3'), faqA3 = document.getElementById('faqA3');

  const grid = document.getElementById('minesGrid');
  const btn  = document.getElementById('fetchBtn');
  const resetBtn = document.getElementById('resetBtn');
  const overlay = document.getElementById('overlay');

  // Глобальные тексты
  let WAIT_MSG = I18N.ar.wait;
  let NEXT_LABEL = I18N.ar.next;
  let BTN_GET = I18N.ar.btnGet;
  let RESET_MSG = I18N.ar.reset;
  let profitMessages = I18N.ar.recs;

  // Таймеры, которые нужно отменять при ресете
  let waitingTimerId = null;   // задержка первого прогноза (3s)
  let revealTimerId  = null;   // анимация раскрытия клетки (1s)

  // Применение языка
  function applyLang(code){
    const d = I18N[code] || I18N.ar;
    htmlEl.lang = d.langTag; htmlEl.dir = d.dir;
    if (titleEl) titleEl.textContent = d.title;
    if (langLbl) langLbl.textContent = d.langName;
    if (langBtn) langBtn.setAttribute('aria-label', d.ariaLang);
    if (onlineLabel) onlineLabel.textContent = d.online;
    if (supportLabel) supportLabel.textContent = d.support;

    if (faqBtnLbl) faqBtnLbl.textContent = d.faqBtn;
    if (faqTitleEl) faqTitleEl.textContent = d.faqTitle;
    if (faqQ1) faqQ1.textContent = d.q1; if (faqA1) faqA1.textContent = d.a1;
    if (faqQ2) faqQ2.textContent = d.q2; if (faqA2) faqA2.textContent = d.a2;
    if (faqQ3) faqQ3.textContent = d.q3; if (faqA3) faqA3.textContent = d.a3;

    BTN_GET = d.btnGet;
    WAIT_MSG = d.wait;
    NEXT_LABEL = d.next;
    RESET_MSG = d.reset;
    profitMessages = d.recs;

    if (btn) btn.textContent = BTN_GET;

    try { localStorage.setItem('preferredLang', code); } catch(_){}
  }

  // Меню языка
  langBtn.addEventListener('click', (e) => {
    e.stopPropagation();
    const isOpen = !langMenu.classList.contains('hidden');
    langMenu.classList.toggle('hidden', isOpen);
    langBtn.setAttribute('aria-expanded', String(!isOpen));
  });
  document.addEventListener('click', () => {
    if (!langMenu.classList.contains('hidden')) {
      langMenu.classList.add('hidden');
      langBtn.setAttribute('aria-expanded','false');
    }
  });
  langMenu.querySelectorAll('button[data-lang]').forEach(b=>{
    b.addEventListener('click', ()=>{
      const code = b.getAttribute('data-lang') || 'ar';
      applyLang(code);
      langMenu.classList.add('hidden');
      langBtn.setAttribute('aria-expanded','false');
    });
  });

  // FAQ show/hide
  const faqPanel = document.getElementById('faqPanel');
  const faqClose = document.getElementById('faqClose');
  faqBtnEl.addEventListener('click', () => faqPanel.classList.toggle('hidden'));
  faqClose.addEventListener('click', () => faqPanel.classList.toggle('hidden'));

  // Инициализация языка
  (function initLang(){
    let code = 'ar';
    try {
      const saved = localStorage.getItem('preferredLang');
      if (saved && I18N[saved]) code = saved;
    } catch(_){}
    applyLang(code);
  })();

  // ===== ЛОГИКА ПРОГНОЗОВ (НЕ менялась) =====
  const MAX_REVEALS = 5;
  let clickCount = 0;
  let firstForecastDone = false;
  const opened = [];

  function initGrid() {
    grid.innerHTML = '';
    opened.length = 0;
    clickCount = 0;
    firstForecastDone = false;
    overlay.classList.add('hidden');
    btn.disabled = false;
    btn.classList.remove('opacity-50','cursor-not-allowed');
    btn.textContent = BTN_GET;

    for (let i = 0; i < 25; i++) {
      const cell = document.createElement('div');
      cell.className = 'w-full h-full bg-green-700 rounded flex items-center justify-center';
      grid.appendChild(cell);
    }
  }
  initGrid();

  btn.addEventListener('click', () => {
    clickCount++;

    if (!firstForecastDone) {
      firstForecastDone = true;
      btn.disabled = true;
      btn.classList.add('opacity-50','cursor-not-allowed');
      overlay.textContent = WAIT_MSG;
      overlay.classList.remove('hidden');
      waitingTimerId = setTimeout(() => {
        overlay.classList.add('hidden');
        btn.disabled = false;
        btn.classList.remove('opacity-50','cursor-not-allowed');
        revealCell();
        waitingTimerId = null;
      }, 3000);
      return;
    }

    if (clickCount <= MAX_REVEALS) {
      revealCell();
      return;
    }

    if (clickCount === MAX_REVEALS + 1) {
      const msg = profitMessages[Math.floor(Math.random() * profitMessages.length)];
      overlay.textContent = msg;
      overlay.classList.remove('hidden');
      btn.textContent = NEXT_LABEL;
      return;
    }

    initGrid();
  });

  // ===== RESET: показать локализованный текст, отменить всё и не выдавать прогноз
  if (resetBtn) {
    resetBtn.addEventListener('click', () => {
      // отменяем все ожидающие действия
      if (waitingTimerId) { clearTimeout(waitingTimerId); waitingTimerId = null; }
      if (revealTimerId)  { clearTimeout(revealTimerId);  revealTimerId  = null; }

      // показываем сообщение о подготовке базы и блокируем кнопки
      overlay.textContent = RESET_MSG;
      overlay.classList.remove('hidden');

      btn.disabled = true;
      resetBtn.disabled = true;
      btn.classList.add('opacity-50','cursor-not-allowed');
      resetBtn.classList.add('opacity-50','cursor-not-allowed');

      // через 3 сек. — чистый сброс без выдачи прогноза
      waitingTimerId = setTimeout(() => {
        initGrid(); // сбрасывает счётчики и скрывает overlay
        btn.disabled = false;
        resetBtn.disabled = false;
        btn.classList.remove('opacity-50','cursor-not-allowed');
        resetBtn.classList.remove('opacity-50','cursor-not-allowed');
        waitingTimerId = null;
      }, 3000);
    });
  }

  function revealCell() {
    const available = Array.from(grid.children).map((_, i) => i).filter(i => !opened.includes(i));
    const idx = available[Math.floor(Math.random() * available.length)];
    opened.push(idx);

    const cell = grid.children[idx];
    cell.classList.add('animate-ping');
    revealTimerId = setTimeout(() => {
      cell.classList.remove('animate-ping');
      cell.innerHTML = `
        <img src="images/01e14e13be54d7a50878cb9370d59d2c.png" alt="Crystal" class="w-full h-full object-contain"/>
      `;
      revealTimerId = null;
    }, 1000);
  }
</script>
</body>
</html>
